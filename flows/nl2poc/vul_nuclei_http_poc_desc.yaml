name: 基于nuclei的HTTP协议PoC的NL2PoC数据集生成
description: 扫描nuclei文件夹，加载每个模板（即漏洞PoC），利用大模型对poc进行描述说明，生成NL2PoC数据集
arguments: 1
consts:
  llm:
    api_base: https://api.chatanywhere.tech
    model: gpt-4o

loader: directory.Directory(arg1, '.yaml', recursive=True)

nodes:
  print: Print
  count: Count(label='level1')
  count2: Count(label='level2')
  count3: Count(label='level3')

  select1: SelectVal('data')
  filter: FieldsExists('info', 'http')
  select: Select('id', 'info.name', 'info.description', 'http')
  rename: RenameFields(http='code')

  poc_desc_prompt: util.files.text('config/prompt/vul-poc-desc.txt')
  poc_desc: model.LLM(**llm, key='code', prompt=poc_desc_prompt, target_key='poc_text')
  writer: WriteJson('data/vul/vul_nuclei_poc_http_LLM_desc.jsonl')

processor: Chain(select1, filter, select, rename, poc_desc, print)
